{% extends "base.html" %}

{% block title %}ðŸ’¬ Chatbot Educativo{% endblock %}

{% block content %}
<h3 class="text-center mt-4 mb-3 text-primary">ðŸ’¬ Chatbot Educativo</h3>
<div class="card p-3 shadow-sm">
  <div id="chat-box" style="height:300px; overflow-y:auto; border:1px solid #ccc; padding:10px; background-color:#f9f9f9; border-radius:8px;"></div>
  <div class="input-group mt-3">
    <input type="text" id="user-input" class="form-control" placeholder="Escribe tu pregunta..." onkeypress="if(event.key === 'Enter') enviarMensaje()">
    <button class="btn btn-primary" onclick="enviarMensaje()">Enviar</button>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function enviarMensaje() {
  const input = document.getElementById('user-input');
  const chatBox = document.getElementById('chat-box');
  const message = input.value.trim();
  if (!message) return;

  chatBox.innerHTML += `
    <div class="mb-2"><span class="badge bg-primary">TÃº</span> ${message}</div>
  `;
  input.value = '';

  fetch('/chat', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ message })
  })
  .then(res => res.json())
  .then(data => {
    chatBox.innerHTML += `
      <div class="mb-2"><span class="badge bg-secondary">Chatbot</span> ${data.response}</div>
    `;
    chatBox.scrollTop = chatBox.scrollHeight;
  });
}
</script>
{% endblock %}
